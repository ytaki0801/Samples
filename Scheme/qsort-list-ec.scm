(use srfi-42)
(define qsort
  (lambda (L)
    (if (null? L) '()
        (let ((p (car L)) (r (cdr L)))
             (append
               (qsort (list-ec (: x r) (if (< x p)) x))
               (list p)
               (qsort (list-ec (: x r) (if (>= x p)) x)))))))
(display (qsort '(14 91 26 58 66 87 25 41 72 50 20 9 27 31 12 28 16 99 100 80 81 44 23 57 96 78 74 5 90 94 48 36 40 82 67 51 19 73 7 39 98 21 0 3 54 49 13 88 38 68 11 43 69 30 77 2 65 24 56 83 62 46 32 37 64 60 61 35 42 47 92 33 53 6 59 97 10 34 89 75 76 93 85 71 84 17 8 1 79 18 4 86 70 55 63 45 29 22 52 15)))
; => (0 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 96 97 98 99 100)
